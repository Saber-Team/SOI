require(["../../lib/util/util","../../lib/events/util","../../lib/events/eventType","../../lib/dom/util","../../lib/string/util","../../lib/net/xhrio","./msg","./service"],function(e,t,n,r,i,o,s,a){"use strict";function u(){"disable"!==y.className&&(y.className="disable"),u.num?(y.innerHTML=i.subs(s.COUNTDOWN,u.num),u.num--,u.timer=setTimeout(u,1e3)):(clearTimeout(u.timer),u.timer=null,u.num=60,y.className="",y.innerHTML=s.BUTTON_TEXT)}function l(e){switch(e){case"number":var t=_.value;return""==i.trim(t)?(m.innerHTML=s.PHONE_NULL,m.style.display="block",!1):h.test(t)?(m.style.display="none",!0):(m.innerHTML=s.PHONE_ERR,m.style.display="block",!1);case"pid":var n=v.value;return""==i.trim(n)?(O.innerHTML=s.PID_NULL,O.style.display="block",!1):p.test(n)?(O.style.display="none",!0):(O.innerHTML=s.PID_FORMAT_ERR,O.style.display="block",!1);default:return!1}}function c(e){e?(d=!0,T.className="disable",y.className="disable"):(d=!1,T.className="",y.className="")}function f(){t.listen(_,n.BLUR,function(){var e=this.value;""==i.trim(e)?(m.innerHTML="",m.style.display="none"):h.test(e)||(m.innerHTML=s.PHONE_ERR,m.style.display="block")},!1,_),t.listen(_,n.KEYUP,function(){var e=this.value;""==i.trim(e)?(m.innerHTML=s.PHONE_NULL,m.style.display="block"):h.test(e)?(m.innerHTML="",m.style.display="none"):(m.innerHTML=s.PHONE_ERR,m.style.display="block")},!1,_),t.listen(y,n.CLICK,function(){if(!d&&!E&&!/disable/.test(y.className)){var e=_.value;l("number")&&(E=!0,a.getPid(function(e){var t=e.target,n=t.getResponseText()-0;1===n?u():0===n?(m.innerHTML=s.NO_PID,m.style.display="block"):-1===n?(m.innerHTML=s.DUP,m.style.display="block"):-2===n?(m.innerHTML=s.SERVER_ERR,m.style.display="block"):(m.innerHTML=s.SERVER_ERR,m.style.display="block"),E=!1},e))}},!1,y),t.listen(T,n.CLICK,function(){if(!d&&!E&&!/disable/.test(T.className)){var e=_.value,t=v.value;l("number")&&l("pid")&&(E=!0,a.sendPid(function(e){var t=e.target,n=t.getResponseText()-0;1==n?g.style.display="block":-1==n?(O.innerHTML=s.PID_ERR,O.style.display="block"):-2==n&&(O.innerHTML=s.SERVER_ERR,O.style.display="block"),E=!1},e,t))}},!1,T),t.listen(N,n.CLICK,function(){g.style.display="none",c(!0)},!1,N)}require.async("./networktest.js",function(){alert(100)}),u.timer=null,u.num=60;var h=/^0?(13[0-9]|15[012356789]|18[0236789]|14[57])[0-9]{8}$/,p=/\d{6}/,d=!1,E=!1,g=r.getElementsByClass("secondary")[0],_=r.getElement("pnum"),y=r.getElement("getpid"),m=r.getElement("getpid_err"),v=r.getElement("pid"),T=r.getElement("submit"),O=r.getElement("submit_err"),N=r.getElement("confirm");f()});